graph TD
    Start[User Query] --> Orchestrator[SmartSearchOrchestrator.answer]
    Orchestrator --> Selector{IntelligentSourceSelector<br/>Classify Domain}
    
    Selector -- "Specific Domain<br/>(Weather/Finance)" --> DomainAPI[Fetch Domain Data]
    DomainAPI --> DirectRes[Direct Response]
    
    Selector -- "General Query" --> SearchDecider{LLM Decision:<br/>Need Search?}
    
    SearchDecider -- "No" --> DirectLLM[LLM Direct Answer]
    
    SearchDecider -- "Yes" --> KeywordGen[Generate Search Keywords]
    KeywordGen --> PipelineSelect{Select Pipeline}
    
    PipelineSelect -- "Search + Local Docs" --> HybridRAG[HybridRAG Pipeline]
    PipelineSelect -- "Search Only" --> NoRAG[NoRAGBaseline Pipeline]
    PipelineSelect -- "Local Docs Only" --> LocalRAG[LocalRAG Pipeline]
    
    subgraph "HybridRAG Pipeline"
        HybridRAG --> ParFetch[Parallel Fetch]
        ParFetch --> WebSearch[Web Search]
        ParFetch --> VecSearch[Vector Store Search]
        WebSearch & VecSearch --> HybridRerank[Rerank Results]
        HybridRerank --> HybridLLM[LLM Synthesis]
    end
    
    subgraph "NoRAGBaseline Pipeline"
        NoRAG --> WebSearchOnly[Web Search]
        WebSearchOnly --> RerankOnly[Rerank Results]
        RerankOnly --> NoRagLLM[LLM Synthesis]
    end
    
    subgraph "LocalRAG Pipeline"
        LocalRAG --> VecSearchOnly[Vector Store Search]
        VecSearchOnly --> LocalLLM[LLM Synthesis]
    end
    
    DirectRes --> Result[Final Answer]
    DirectLLM --> Result
    HybridLLM --> Result
    NoRagLLM --> Result
    LocalLLM --> Result
